<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>Events - Phase 2 - Create</name>
    <events>
        <include>Events - Common</include>
        <event-group description="" sid="4137865588677511" title="LAYOUT ROOT">
            <sub-events>
                <variable constant="0" name="CENTER_X" sid="3219718291974603" static="1" type="number">0</variable>
                <variable constant="0" name="CENTER_Y" sid="6802560652983374" static="1" type="number">0</variable>
                <variable constant="0" name="R" sid="1250391655452096" static="1" type="number">0</variable>
                <variable constant="1" name="POSITION_Y" sid="7039048524514207" static="1" type="number">200</variable>
                <variable constant="1" name="VISIBLE_ANGLE" sid="1147343489112532" static="1" type="number">40</variable>
                <variable constant="1" name="POSITIONING_DISTANCE" sid="2519607737337948" static="1" type="number">120</variable>
                <variable constant="1" name="OVERLAP_RATIO" sid="1467674208288974" static="1" type="number">0.15</variable>
                <variable constant="1" name="SLIDE_SPEED" sid="6416486524362268" static="1" type="number">10</variable>
                <variable constant="0" name="CircleX" sid="5664118315396733" static="1" type="number">0</variable>
                <variable constant="0" name="CircleY" sid="7679215850877626" static="1" type="number">0</variable>
                <event-group collapsed="1" description="" sid="7794063342821028" title="necklace setup, flower drag and drop">
                    <sub-events>
                        <event-block sid="6814207576628957">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="2916607859681267" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="9119203713341441" type="System">
                                    <param id="0" name="Variable">R</param>
                                    <param id="1" name="Value">abs((ViewportRight (0)- ViewportLeft(0)) / 2 / cos(90-VISIBLE_ANGLE/2))</param>
                                </action>
                                <action id="-9" name="Set value" sid="1522665260619179" type="System">
                                    <param id="0" name="Variable">CENTER_X</param>
                                    <param id="1" name="Value">LayoutWidth / 2</param>
                                </action>
                                <action id="-9" name="Set value" sid="6233656270218546" type="System">
                                    <param id="0" name="Variable">CENTER_Y</param>
                                    <param id="1" name="Value">ViewportTop(0) - R + POSITION_Y</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="6944167719422723">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="2451817903902349" type="System" />
                                <condition id="-10" name="For" sid="2852441251628923" type="System">
                                    <param id="0" name="Name">&quot;angle&quot;</param>
                                    <param id="1" name="Start index">90-VISIBLE_ANGLE/2</param>
                                    <param id="2" name="End index">90+VISIBLE_ANGLE/2</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="2702737521522551" type="Function">
                                    <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                                    <param id="1" name="Parameter {n}">R{###}loopindex</param>
                                </action>
                                <action id="-3" name="Create object" sid="8893559101239566" type="System">
                                    <param id="0" name="Object to create">RedDot</param>
                                    <param id="1" name="Layer">0</param>
                                    <param id="2" name="X">CircleX</param>
                                    <param id="3" name="Y">CircleY</param>
                                </action>
                                <action id="-8" name="Set angle" sid="3146435746707184" type="RedDot">
                                    <param id="0" name="Angle">loopindex</param>
                                </action>
                                <action id="0" name="Call function" sid="6401354105353083" type="Function">
                                    <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                                    <param id="1" name="Parameter {n}">R + POSITIONING_DISTANCE{###}loopindex</param>
                                </action>
                                <action id="-3" name="Create object" sid="2721224230043301" type="System">
                                    <param id="0" name="Object to create">RedDot</param>
                                    <param id="1" name="Layer">0</param>
                                    <param id="2" name="X">CircleX</param>
                                    <param id="3" name="Y">CircleY</param>
                                </action>
                                <action id="-8" name="Set angle" sid="5690972141879994" type="RedDot">
                                    <param id="0" name="Angle">loopindex</param>
                                </action>
                                <action id="-16" name="Set opacity" sid="1577849246153844" type="RedDot">
                                    <param id="0" name="Opacity">10</param>
                                </action>
                            </actions>
                        </event-block>
                        <variable constant="0" name="flower_distance" sid="404980037874719" static="0" type="number">0</variable>
                        <event-block sid="1455233782599088">
                            <conditions>
                                <condition behavior="DragDrop" id="1" name="On drag start" sid="3278401751719628" type="Flower" />
                            </conditions>
                            <actions>
                                <action id="-24" name="Move to top" sid="4831145815730317" type="Flower" />
                            </actions>
                        </event-block>
                        <event-block sid="4013982847405576">
                            <conditions>
                                <condition behavior="DragDrop" id="0" name="Is dragging" sid="4307212809755078" type="Flower" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="198204358810944" type="System">
                                    <param id="0" name="Variable">flower_distance</param>
                                    <param id="1" name="Value">distance(CENTER_X, CENTER_Y, Flower.X, Flower.Y)</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="3725350389971643">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="6540975687340696" type="System">
                                            <param id="0" name="First value">flower_distance</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Second value">R + POSITIONING_DISTANCE</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="7498356775779817" type="Flower">
                                            <param id="0" name="Instance variable">CircleAngle</param>
                                            <param id="1" name="Value">angle(CENTER_X, CENTER_Y, Flower.X, Flower.Y)</param>
                                        </action>
                                        <action id="-8" name="Set angle" sid="7041637424410707" type="Flower">
                                            <param id="0" name="Angle">Flower.CircleAngle-90</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="7954925149452342">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="424761665263879" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-8" name="Set angle" sid="1261330315150073" type="Flower">
                                            <param id="0" name="Angle">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="5677188418114897">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="3097246737771131" type="System">
                                            <param id="0" name="First value">flower_distance</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Second value">R</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="8254873340805901" type="Function">
                                            <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                                            <param id="1" name="Parameter {n}">R{###}Flower.CircleAngle</param>
                                        </action>
                                        <action id="-3" name="Set position" sid="5754879303735921" type="Flower">
                                            <param id="0" name="X">CircleX</param>
                                            <param id="1" name="Y">CircleY</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="7988599145093152">
                            <conditions>
                                <condition behavior="DragDrop" id="2" name="On drop" sid="7736769868821621" type="Flower" />
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="142306823703036">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="5324632533072034" type="System">
                                            <param id="0" name="First value">flower_distance</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Second value">R + POSITIONING_DISTANCE</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="1576234197413269" type="Function">
                                            <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                                            <param id="1" name="Parameter {n}">R{###}Flower.CircleAngle</param>
                                        </action>
                                        <action id="-3" name="Set position" sid="7136734303591117" type="Flower">
                                            <param id="0" name="X">CircleX</param>
                                            <param id="1" name="Y">CircleY</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group collapsed="1" description="" sid="373608831914356" title="dynamic flower positioning">
                    <sub-events>
                        <variable constant="0" name="FlowersCount" sid="8522124805697867" static="0" type="number">0</variable>
                        <variable constant="0" name="Length" sid="726844605342866" static="1" type="number">0</variable>
                        <variable constant="0" name="Offset" sid="7307237996979332" static="0" type="number">0</variable>
                        <variable constant="0" name="StartAngle" sid="106807981843684" static="0" type="number">0</variable>
                        <event-block sid="1141648765907089">
                            <conditions />
                            <actions />
                        </event-block>
                        <event-block sid="5730033345963447">
                            <conditions>
                                <condition id="-33" name="Pick by comparison" sid="8010180756291331" type="System">
                                    <param id="0" name="Object">Flower</param>
                                    <param id="1" name="Expression">distance(Flower.X, Flower.Y, CENTER_X, CENTER_Y)</param>
                                    <param id="2" name="Comparison">2</param>
                                    <param id="3" name="Value">R+POSITIONING_DISTANCE</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="6673491608264741" type="System">
                                    <param id="0" name="Variable">Length</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                                <action id="-9" name="Set value" sid="4751851050356559" type="System">
                                    <param id="0" name="Variable">Offset</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                                <action id="-9" name="Set value" sid="6328552889923988" type="System">
                                    <param id="0" name="Variable">FlowersCount</param>
                                    <param id="1" name="Value">Flower.PickedCount</param>
                                </action>
                            </actions>
                            <sub-events>
                                <comment>calculate the start angle of the necklace and the angle offset for the end position of each flower on the necklace</comment>
                                <event-block sid="4412695468845357">
                                    <conditions>
                                        <condition id="-24" name="For Each (ordered)" sid="3159815390230754" type="System">
                                            <param id="0" name="Object">Flower</param>
                                            <param id="1" name="Expression">Flower.CircleAngle</param>
                                            <param id="2" name="Order">0</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block any="1" sid="4606712756452626">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="8550545460467115" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">0</param>
                                                </condition>
                                                <condition id="-8" name="Compare two values" sid="75210037865348" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">FlowersCount - 1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="6821985172152969" type="System">
                                                    <param id="0" name="Variable">Length</param>
                                                    <param id="1" name="Value">Length + Flower.Width * (0.5 - OVERLAP_RATIO)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="2780711552556971">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="750778170806318" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="6132666903758566" type="System">
                                                    <param id="0" name="Variable">Length</param>
                                                    <param id="1" name="Value">Length + Flower.Width * (1 - OVERLAP_RATIO * 2)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block any="1" sid="9787548401021362">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="8688630123385861" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">2</param>
                                                    <param id="2" name="Second value">FlowersCount - 1</param>
                                                </condition>
                                                <condition id="-8" name="Compare two values" sid="8443414573086783" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="4819022613238821" type="System">
                                                    <param id="0" name="Variable">Offset</param>
                                                    <param id="1" name="Value">Length - Flower.Width * (0.5 - OVERLAP_RATIO)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="399835719861915">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="6361449711773692" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="2461280118049327" type="System">
                                                    <param id="0" name="Variable">Offset</param>
                                                    <param id="1" name="Value">Length</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="2748743070175341">
                                            <conditions />
                                            <actions>
                                                <action id="-10" name="Set value" sid="5104029568722151" type="Flower">
                                                    <param id="0" name="Instance variable">StartAngleOffset</param>
                                                    <param id="1" name="Value">180 / pi * Offset / R</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="3436117826431733">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="8378923963451775" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">FlowersCount - 1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="2364997931597442" type="System">
                                                    <param id="0" name="Variable">StartAngle</param>
                                                    <param id="1" name="Value">90 - Flower.StartAngleOffset / 2</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <comment>slide each flower towards its end position</comment>
                                <variable constant="0" name="AngleDifference" sid="7751581080352085" static="0" type="number">0</variable>
                                <event-block sid="5601187823617232">
                                    <conditions>
                                        <condition id="-24" name="For Each (ordered)" sid="6277012592704398" type="System">
                                            <param id="0" name="Object">Flower</param>
                                            <param id="1" name="Expression">Flower.CircleAngle</param>
                                            <param id="2" name="Order">0</param>
                                        </condition>
                                        <condition behavior="DragDrop" id="0" inverted="1" name="Is dragging" sid="5337946490081192" type="Flower" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="8537647783860167" type="System">
                                            <param id="0" name="Variable">AngleDifference</param>
                                            <param id="1" name="Value">(StartAngle + Flower.StartAngleOffset) - Flower.CircleAngle</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="4517039086659289">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="6124984471103008" type="System">
                                                    <param id="0" name="First value">abs(AngleDifference)</param>
                                                    <param id="1" name="Comparison">2</param>
                                                    <param id="2" name="Second value">SLIDE_SPEED * dt</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="6281626091491547" type="Flower">
                                                    <param id="0" name="Instance variable">CircleAngle</param>
                                                    <param id="1" name="Value">StartAngle + Flower.StartAngleOffset</param>
                                                </action>
                                                <action id="0" name="Call function" sid="2391576953798707" type="Function">
                                                    <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                                                    <param id="1" name="Parameter {n}">R{###}Flower.CircleAngle</param>
                                                </action>
                                                <action id="-3" name="Set position" sid="9478073178807512" type="Flower">
                                                    <param id="0" name="X">CircleX</param>
                                                    <param id="1" name="Y">CircleY</param>
                                                </action>
                                                <action id="-8" name="Set angle" sid="2935528487068181" type="Flower">
                                                    <param id="0" name="Angle">Flower.CircleAngle - 90</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="6579805775674016">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="9034088257747038" type="System" />
                                                <condition id="-8" name="Compare two values" sid="2595643280538478" type="System">
                                                    <param id="0" name="First value">AngleDifference</param>
                                                    <param id="1" name="Comparison">4</param>
                                                    <param id="2" name="Second value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="298045249438673" type="Function">
                                                    <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                                                    <param id="1" name="Parameter {n}">R{###}angle(CENTER_X, CENTER_Y, Flower.X, Flower.Y) + SLIDE_SPEED * dt</param>
                                                </action>
                                                <action id="-3" name="Set position" sid="5786857048506356" type="Flower">
                                                    <param id="0" name="X">CircleX</param>
                                                    <param id="1" name="Y">CircleY</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="8358421384463115" type="Flower">
                                                    <param id="0" name="Instance variable">CircleAngle</param>
                                                    <param id="1" name="Value">angle(CENTER_X, CENTER_Y, Flower.X, Flower.Y)</param>
                                                </action>
                                                <action id="-8" name="Set angle" sid="9902229300592356" type="Flower">
                                                    <param id="0" name="Angle">Flower.CircleAngle - 90</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="9951369969970039">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="3852733984829281" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="3259131439075843" type="Function">
                                                    <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                                                    <param id="1" name="Parameter {n}">R{###}angle(CENTER_X, CENTER_Y, Flower.X, Flower.Y) - SLIDE_SPEED * dt</param>
                                                </action>
                                                <action id="-3" name="Set position" sid="9816421367945918" type="Flower">
                                                    <param id="0" name="X">CircleX</param>
                                                    <param id="1" name="Y">CircleY</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="321988774305452" type="Flower">
                                                    <param id="0" name="Instance variable">CircleAngle</param>
                                                    <param id="1" name="Value">angle(CENTER_X, CENTER_Y, Flower.X, Flower.Y)</param>
                                                </action>
                                                <action id="-8" name="Set angle" sid="5121246746774932" type="Flower">
                                                    <param id="0" name="Angle">Flower.CircleAngle - 90</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <event-block sid="1743562020291027">
                                    <conditions />
                                    <actions />
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-block sid="6108021280259306">
                    <conditions>
                        <condition id="0" name="On function" sid="5059879892503378" type="Function">
                            <param id="0" name="Name">&quot;UpdateCircleXY&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" sid="6369028732026035" type="System">
                            <param id="0" name="Variable">CircleX</param>
                            <param id="1" name="Value">CENTER_X + Function.Param(0) * cos(Function.Param(1))</param>
                        </action>
                        <action id="-9" name="Set value" sid="4411156778236766" type="System">
                            <param id="0" name="Variable">CircleY</param>
                            <param id="1" name="Value">CENTER_Y + Function.Param(0) * sin(Function.Param(1))</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
