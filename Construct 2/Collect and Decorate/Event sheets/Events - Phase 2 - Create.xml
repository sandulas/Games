<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>Events - Phase 2 - Create</name>
    <events>
        <include>Events - Common</include>
        <variable constant="0" name="IsNewNecklace" sid="7660287928391378" static="0" type="number">0</variable>
        <event-group description="" sid="4137865588677511" title="LAYOUT ROOT">
            <sub-events>
                <variable constant="0" name="StringY" sid="7039048524514207" static="1" type="number">180</variable>
                <variable constant="0" name="PositioningDistance" sid="2519607737337948" static="1" type="number">0</variable>
                <variable constant="0" name="SlideSpeed" sid="6416486524362268" static="1" type="number">10</variable>
                <variable constant="0" name="PieceCount" sid="7006133053701937" static="1" type="number">0</variable>
                <variable constant="0" name="VisibleAngle" sid="8574276399323928" static="1" type="number">0</variable>
                <variable constant="0" name="PieceScaleEnd" sid="8445817006450812" static="1" type="number">0</variable>
                <variable constant="0" name="IsFinished" sid="6464492509322654" static="1" type="number">0</variable>
                <variable constant="0" name="PieceScaleAttenuationPerDegree" sid="2360829174042939" static="1" type="number">0</variable>
                <event-group collapsed="1" description="" sid="7957432436885679" title="setup UI">
                    <sub-events>
                        <variable constant="0" name="FlowerDistance" sid="9168820167331815" static="0" type="number">0</variable>
                        <event-block collapsed="1" sid="8114446928733638">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="4848461302335254" type="System" />
                            </conditions>
                            <actions>
                                <action id="-2" name="Set Y" sid="2618290026747617" type="UI_NecklaceEmptyBig">
                                    <param id="0" name="Y">ViewportTop(0) + StringY</param>
                                </action>
                                <action id="-9" name="Set value" sid="2332347251975737" type="System">
                                    <param id="0" name="Variable">PieceCount</param>
                                    <param id="1" name="Value">Function.Call(&quot;NecklacePieceCount&quot;, Level, SaveSlot)</param>
                                </action>
                                <action id="-9" name="Set value" sid="4801025498424616" type="System">
                                    <param id="0" name="Variable">FlowerDistance</param>
                                    <param id="1" name="Value">(ViewportRight(0) - ViewportLeft(0)) / PieceCount</param>
                                </action>
                                <action id="-9" name="Set value" sid="1255659915947986" type="System">
                                    <param id="0" name="Variable">CirclePieceScale</param>
                                    <param id="1" name="Value">Level = 1 ? 1.1 : Level = 2 ? 0.9 : 0.7</param>
                                </action>
                                <action id="-9" name="Set value" sid="4527520391827752" type="System">
                                    <param id="0" name="Variable">PositioningDistance</param>
                                    <param id="1" name="Value">CirclePieceScale * 188 * 0.8</param>
                                </action>
                                <action id="-9" name="Set value" sid="5372211446550101" type="System">
                                    <param id="0" name="Variable">CircleR</param>
                                    <param id="1" name="Value">1560</param>
                                </action>
                                <action id="-9" name="Set value" sid="1522665260619179" type="System">
                                    <param id="0" name="Variable">CircleCenterX</param>
                                    <param id="1" name="Value">LayoutWidth / 2</param>
                                </action>
                                <action id="-9" name="Set value" sid="6233656270218546" type="System">
                                    <param id="0" name="Variable">CircleCenterY</param>
                                    <param id="1" name="Value">ViewportTop(0) - CircleR + StringY + 64</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="5549015629467374">
                                    <conditions>
                                        <condition id="3" name="Compare frame" sid="3305996834841112" type="Button">
                                            <param id="0" name="Comparison">0</param>
                                            <param id="1" name="Number">6</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-3" name="Set position" sid="1133068019008419" type="Button">
                                            <param id="0" name="X">ViewportRight(0) - 70</param>
                                            <param id="1" name="Y">450</param>
                                        </action>
                                        <action id="-15" name="Set visible" sid="1546542327533115" type="Button">
                                            <param id="0" name="Visibility">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block collapsed="1" sid="3911541784983441">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="3950557489266894" type="System" />
                            </conditions>
                            <actions />
                            <sub-events>
                                <comment>if coming from the collect layout, load the collected flowers (level 0, slot 8 of the NecklacesArray) on the bottom of the screen</comment>
                                <event-block sid="2116438334907554">
                                    <conditions>
                                        <condition id="2" name="Compare at XYZ" sid="3201840944284674" type="NecklacesArray">
                                            <param id="0" name="X">0</param>
                                            <param id="1" name="Y">8</param>
                                            <param id="2" name="Z">0</param>
                                            <param id="3" name="Comparison">1</param>
                                            <param id="4" name="Value">-1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="8987523410203984" type="System">
                                            <param id="0" name="Variable">IsNewNecklace</param>
                                            <param id="1" name="Value">1</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="5987469337399385">
                                            <conditions>
                                                <condition id="-10" name="For" sid="7274203368199563" type="System">
                                                    <param id="0" name="Name">&quot;i&quot;</param>
                                                    <param id="1" name="Start index">0</param>
                                                    <param id="2" name="End index">PieceCount - 1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-3" name="Create object" sid="3921273935650137" type="System">
                                                    <param id="0" name="Object to create">Flower</param>
                                                    <param id="1" name="Layer">2</param>
                                                    <param id="2" name="X">ViewportLeft(0) + FlowerDistance / 2 + FlowerDistance * loopindex</param>
                                                    <param id="3" name="Y">0</param>
                                                </action>
                                                <action id="9" name="Set scale" sid="9341178832043684" type="Flower">
                                                    <param id="0" name="Scale">CirclePieceScale * 0.8</param>
                                                </action>
                                                <action id="-2" name="Set Y" sid="3164012313528174" type="Flower">
                                                    <param id="0" name="Y">ViewportBottom(0) - Flower.Height / 2 - (loopindex %2) * Flower.Height / 2</param>
                                                </action>
                                                <action id="5" name="Set frame" sid="3428049239321407" type="Flower">
                                                    <param id="0" name="Frame number">NecklacesArray.At(0, 8, loopindex)</param>
                                                </action>
                                                <action behavior="DragDrop" id="0" name="Set enabled" sid="330451230319382" type="Flower">
                                                    <param id="0" name="State">1</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="7699885869046905">
                                            <conditions>
                                                <condition id="3" name="Compare frame" sid="2908306156488563" type="Button">
                                                    <param id="0" name="Comparison">0</param>
                                                    <param id="1" name="Number">5</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action disabled="1" id="-10" name="Set value" sid="3362290228747269" type="Button">
                                                    <param id="0" name="Instance variable">action</param>
                                                    <param id="1" name="Value">&quot;Phase 1 - Collect&quot;</param>
                                                </action>
                                                <action disabled="1" id="-10" name="Set value" sid="4501121796368889" type="Button">
                                                    <param id="0" name="Instance variable">parameter</param>
                                                    <param id="1" name="Value">SaveSlot</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="7076032378221078" type="Button">
                                                    <param id="0" name="Instance variable">action</param>
                                                    <param id="1" name="Value">&quot;Saves&quot;</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="5099414100956017" type="Button">
                                                    <param id="0" name="Instance variable">parameter</param>
                                                    <param id="1" name="Value">Level</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="1764487867399816">
                                            <conditions />
                                            <actions>
                                                <action id="-24" name="Move to top" sid="2625659440097802" type="Fader" />
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <comment>if coming from the saves layout, create the pieces of the selected necklace on the string</comment>
                                <event-block sid="4301057509489492">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="258477700492467" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="8788690809962956" type="System">
                                            <param id="0" name="Variable">IsNewNecklace</param>
                                            <param id="1" name="Value">0</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="5497133538734201" type="System">
                                            <param id="0" name="Variable">StartAngleIndex</param>
                                            <param id="1" name="Value">0</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="3539223127402058" type="System">
                                            <param id="0" name="Variable">CirclePieceOverlapRatio</param>
                                            <param id="1" name="Value">0.3</param>
                                        </action>
                                        <action id="0" name="Call function" sid="2215963609507152" type="Function">
                                            <param id="0" name="Name">&quot;CreateNecklacePieces&quot;</param>
                                            <param id="1" name="Parameter {n}">Level{###}SaveSlot</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="7435657546935912">
                                            <conditions>
                                                <condition id="3" name="Compare frame" sid="1433518437768177" type="Button">
                                                    <param id="0" name="Comparison">0</param>
                                                    <param id="1" name="Number">5</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="5190604309768332" type="Button">
                                                    <param id="0" name="Instance variable">action</param>
                                                    <param id="1" name="Value">&quot;Saves&quot;</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="4875589421095302" type="Button">
                                                    <param id="0" name="Instance variable">parameter</param>
                                                    <param id="1" name="Value">Level</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>arrange the pieces of the selected necklace on the string (this has to be done on a different top-level event becuase you cannot manipulate sprites created in the same event)</comment>
                        <event-block collapsed="1" sid="4655173225565693">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="5590726737270561" type="System" />
                                <condition id="2" name="Compare at XYZ" sid="9040172831799318" type="NecklacesArray">
                                    <param id="0" name="X">0</param>
                                    <param id="1" name="Y">8</param>
                                    <param id="2" name="Z">0</param>
                                    <param id="3" name="Comparison">0</param>
                                    <param id="4" name="Value">-1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="190361791067632" type="System">
                                    <param id="0" name="Variable">StartAngleIndex</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                                <action id="0" name="Call function" sid="7856703299306925" type="Function">
                                    <param id="0" name="Name">&quot;ArrangeNecklacePieces&quot;</param>
                                    <param id="1" name="Parameter {n}">Level{###}SaveSlot</param>
                                </action>
                                <action behavior="DragDrop" id="0" name="Set enabled" sid="5475116346408697" type="Flower">
                                    <param id="0" name="State">1</param>
                                </action>
                                <action id="-9" name="Set value" sid="8377098550431007" type="System">
                                    <param id="0" name="Variable">CirclePieceOverlapRatio</param>
                                    <param id="1" name="Value">0.15</param>
                                </action>
                                <action id="-24" name="Move to top" sid="279741825765489" type="Fader" />
                            </actions>
                            <sub-events>
                                <event-block sid="8892080372028061">
                                    <conditions>
                                        <condition id="3" name="Compare frame" sid="5171801127973596" type="Button">
                                            <param id="0" name="Comparison">0</param>
                                            <param id="1" name="Number">6</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-15" name="Set visible" sid="1514070949290973" type="Button">
                                            <param id="0" name="Visibility">1</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="3880124379192509" type="System">
                                            <param id="0" name="Variable">IsFinished</param>
                                            <param id="1" name="Value">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group collapsed="1" description="" sid="7794063342821028" title="necklace setup, flower drag and drop">
                    <sub-events>
                        <event-block sid="6814207576628957">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="2916607859681267" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="3700664504186394" type="System">
                                    <param id="0" name="Variable">VisibleAngle</param>
                                    <param id="1" name="Value">int(asin(((ViewportRight(0) - ViewportLeft(0)) / 2) / CircleR)) - 4</param>
                                </action>
                                <action id="-9" name="Set value" sid="9596657165337058" type="System">
                                    <param id="0" name="Variable">PieceScaleEnd</param>
                                    <param id="1" name="Value">CirclePieceScale * CirclePieceScaleAttenuation</param>
                                </action>
                                <action id="-9" name="Set value" sid="9785180818034749" type="System">
                                    <param id="0" name="Variable">PieceScaleAttenuationPerDegree</param>
                                    <param id="1" name="Value">(CirclePieceScale - PieceScaleEnd) / VisibleAngle</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block disabled="1" sid="6944167719422723">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="2451817903902349" type="System" />
                                <condition id="-10" name="For" sid="2852441251628923" type="System">
                                    <param id="0" name="Name">&quot;angle&quot;</param>
                                    <param id="1" name="Start index">90 - VisibleAngle</param>
                                    <param id="2" name="End index">90 + VisibleAngle</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="2702737521522551" type="Function">
                                    <param id="0" name="Name">&quot;SetOnCircleXY&quot;</param>
                                    <param id="1" name="Parameter {n}">loopindex</param>
                                </action>
                                <action id="-3" name="Create object" sid="8893559101239566" type="System">
                                    <param id="0" name="Object to create">RedDot</param>
                                    <param id="1" name="Layer">0</param>
                                    <param id="2" name="X">CircleCenterX + OnCircleX</param>
                                    <param id="3" name="Y">CircleCenterY + OnCircleY</param>
                                </action>
                                <action id="-8" name="Set angle" sid="3146435746707184" type="RedDot">
                                    <param id="0" name="Angle">loopindex</param>
                                </action>
                                <action id="-9" name="Set value" sid="6929337406067595" type="System">
                                    <param id="0" name="Variable">CircleR</param>
                                    <param id="1" name="Value">CircleR + PositioningDistance</param>
                                </action>
                                <action id="0" name="Call function" sid="6488277065017468" type="Function">
                                    <param id="0" name="Name">&quot;SetOnCircleXY&quot;</param>
                                    <param id="1" name="Parameter {n}">loopindex</param>
                                </action>
                                <action id="-9" name="Set value" sid="9344786422150033" type="System">
                                    <param id="0" name="Variable">CircleR</param>
                                    <param id="1" name="Value">CircleR - PositioningDistance</param>
                                </action>
                                <action id="-3" name="Create object" sid="2721224230043301" type="System">
                                    <param id="0" name="Object to create">RedDot</param>
                                    <param id="1" name="Layer">0</param>
                                    <param id="2" name="X">CircleCenterX + OnCircleX</param>
                                    <param id="3" name="Y">CircleCenterY + OnCircleY</param>
                                </action>
                                <action id="-8" name="Set angle" sid="5690972141879994" type="RedDot">
                                    <param id="0" name="Angle">loopindex</param>
                                </action>
                                <action id="-16" name="Set opacity" sid="1577849246153844" type="RedDot">
                                    <param id="0" name="Opacity">20</param>
                                </action>
                            </actions>
                        </event-block>
                        <variable constant="0" name="flower_distance" sid="404980037874719" static="0" type="number">0</variable>
                        <event-block sid="1455233782599088">
                            <conditions>
                                <condition behavior="DragDrop" id="1" name="On drag start" sid="3278401751719628" type="Flower" />
                            </conditions>
                            <actions>
                                <action id="-24" name="Move to top" sid="4831145815730317" type="Flower" />
                            </actions>
                        </event-block>
                        <event-block sid="4013982847405576">
                            <conditions>
                                <condition behavior="DragDrop" id="0" name="Is dragging" sid="4307212809755078" type="Flower" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="198204358810944" type="System">
                                    <param id="0" name="Variable">flower_distance</param>
                                    <param id="1" name="Value">distance(CircleCenterX, CircleCenterY, Flower.X, Flower.Y)</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="3725350389971643">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="6540975687340696" type="System">
                                            <param id="0" name="First value">flower_distance</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Second value">CircleR + PositioningDistance</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="7498356775779817" type="Flower">
                                            <param id="0" name="Instance variable">CircleAngle</param>
                                            <param id="1" name="Value">angle(CircleCenterX, CircleCenterY, Flower.X, Flower.Y)</param>
                                        </action>
                                        <action id="-8" name="Set angle" sid="7041637424410707" type="Flower">
                                            <param id="0" name="Angle">Flower.CircleAngle-90</param>
                                        </action>
                                        <action id="9" name="Set scale" sid="5725162656610602" type="Flower">
                                            <param id="0" name="Scale">CirclePieceScale - abs(90 - Flower.CircleAngle) * PieceScaleAttenuationPerDegree</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="7954925149452342">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="424761665263879" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-8" name="Set angle" sid="1261330315150073" type="Flower">
                                            <param id="0" name="Angle">0</param>
                                        </action>
                                        <action id="9" name="Set scale" sid="2526882717613844" type="Flower">
                                            <param id="0" name="Scale">CirclePieceScale * 0.8</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="5677188418114897">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="3097246737771131" type="System">
                                            <param id="0" name="First value">flower_distance</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Second value">CircleR</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="8960224894962986" type="Function">
                                            <param id="0" name="Name">&quot;SetOnCircleXY&quot;</param>
                                            <param id="1" name="Parameter {n}">Flower.CircleAngle</param>
                                        </action>
                                        <action id="-3" name="Set position" sid="5754879303735921" type="Flower">
                                            <param id="0" name="X">OnCircleX + CircleCenterX</param>
                                            <param id="1" name="Y">OnCircleY + CircleCenterY</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="7988599145093152">
                            <conditions>
                                <condition behavior="DragDrop" id="2" name="On drop" sid="7736769868821621" type="Flower" />
                            </conditions>
                            <actions />
                            <sub-events>
                                <comment>snap the flower on the circle if it&apos;s dropped close enough</comment>
                                <event-block sid="142306823703036">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="5324632533072034" type="System">
                                            <param id="0" name="First value">flower_distance</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Second value">CircleR + PositioningDistance</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="6953063438511336" type="Function">
                                            <param id="0" name="Name">&quot;SetOnCircleXY&quot;</param>
                                            <param id="1" name="Parameter {n}">Flower.CircleAngle</param>
                                        </action>
                                        <action id="-3" name="Set position" sid="1879295735212432" type="Flower">
                                            <param id="0" name="X">OnCircleX + CircleCenterX</param>
                                            <param id="1" name="Y">OnCircleY + CircleCenterY</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>if all the flowers are on the circle, show the next button</comment>
                                <event-block sid="6151229530191085">
                                    <conditions>
                                        <condition id="-19" name="Pick all" sid="7010312159890282" type="System">
                                            <param id="0" name="Object">Flower</param>
                                        </condition>
                                        <condition id="-33" name="Pick by comparison" sid="8012159532994325" type="System">
                                            <param id="0" name="Object">Flower</param>
                                            <param id="1" name="Expression">distance(Flower.X, Flower.Y, CircleCenterX, CircleCenterY)</param>
                                            <param id="2" name="Comparison">2</param>
                                            <param id="3" name="Value">CircleR +PositioningDistance</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="9574657804643069">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="2386535758249028" type="System">
                                                    <param id="0" name="First value">Flower.PickedCount</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">PieceCount</param>
                                                </condition>
                                            </conditions>
                                            <actions />
                                            <sub-events>
                                                <event-block sid="8720405304287456">
                                                    <conditions>
                                                        <condition id="3" name="Compare frame" sid="1613484121033864" type="Button">
                                                            <param id="0" name="Comparison">0</param>
                                                            <param id="1" name="Number">6</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="-15" name="Set visible" sid="9570078235300435" type="Button">
                                                            <param id="0" name="Visibility">1</param>
                                                        </action>
                                                        <action id="-9" name="Set value" sid="9036421607254294" type="System">
                                                            <param id="0" name="Variable">IsFinished</param>
                                                            <param id="1" name="Value">1</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                        <event-block sid="7907582749224188">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="1961005378185069" type="System" />
                                            </conditions>
                                            <actions />
                                            <sub-events>
                                                <event-block sid="9558410773632453">
                                                    <conditions>
                                                        <condition id="3" name="Compare frame" sid="9895585158180448" type="Button">
                                                            <param id="0" name="Comparison">0</param>
                                                            <param id="1" name="Number">6</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="-15" name="Set visible" sid="5012101022325061" type="Button">
                                                            <param id="0" name="Visibility">0</param>
                                                        </action>
                                                        <action id="-9" name="Set value" sid="5553448369222847" type="System">
                                                            <param id="0" name="Variable">IsFinished</param>
                                                            <param id="1" name="Value">0</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group collapsed="1" description="" sid="373608831914356" title="dynamic flower positioning">
                    <sub-events>
                        <variable constant="0" name="FlowersCount" sid="8522124805697867" static="0" type="number">0</variable>
                        <variable constant="0" name="Length" sid="726844605342866" static="1" type="number">0</variable>
                        <variable constant="0" name="Offset" sid="7307237996979332" static="0" type="number">0</variable>
                        <variable constant="0" name="StartAngle" sid="106807981843684" static="0" type="number">0</variable>
                        <event-block sid="5730033345963447">
                            <conditions>
                                <condition id="-33" name="Pick by comparison" sid="8010180756291331" type="System">
                                    <param id="0" name="Object">Flower</param>
                                    <param id="1" name="Expression">distance(Flower.X, Flower.Y, CircleCenterX, CircleCenterY)</param>
                                    <param id="2" name="Comparison">2</param>
                                    <param id="3" name="Value">CircleR +PositioningDistance</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="6673491608264741" type="System">
                                    <param id="0" name="Variable">Length</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                                <action id="-9" name="Set value" sid="4751851050356559" type="System">
                                    <param id="0" name="Variable">Offset</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                                <action id="-9" name="Set value" sid="6328552889923988" type="System">
                                    <param id="0" name="Variable">FlowersCount</param>
                                    <param id="1" name="Value">Flower.PickedCount</param>
                                </action>
                            </actions>
                            <sub-events>
                                <comment>calculate the start angle of the necklace and the angle offset for the end position of each flower on the necklace</comment>
                                <event-block sid="4412695468845357">
                                    <conditions>
                                        <condition id="-24" name="For Each (ordered)" sid="3159815390230754" type="System">
                                            <param id="0" name="Object">Flower</param>
                                            <param id="1" name="Expression">Flower.CircleAngle</param>
                                            <param id="2" name="Order">0</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block any="1" sid="4606712756452626">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="8550545460467115" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">0</param>
                                                </condition>
                                                <condition id="-8" name="Compare two values" sid="75210037865348" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">FlowersCount - 1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="6821985172152969" type="System">
                                                    <param id="0" name="Variable">Length</param>
                                                    <param id="1" name="Value">Length + Flower.Width * (0.5 - CirclePieceOverlapRatio)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="2780711552556971">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="750778170806318" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="6132666903758566" type="System">
                                                    <param id="0" name="Variable">Length</param>
                                                    <param id="1" name="Value">Length + Flower.Width * (1 - CirclePieceOverlapRatio * 2)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block any="1" sid="9787548401021362">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="8688630123385861" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">2</param>
                                                    <param id="2" name="Second value">FlowersCount - 1</param>
                                                </condition>
                                                <condition id="-8" name="Compare two values" sid="8443414573086783" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="4819022613238821" type="System">
                                                    <param id="0" name="Variable">Offset</param>
                                                    <param id="1" name="Value">Length - Flower.Width * (0.5 - CirclePieceOverlapRatio)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="399835719861915">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="6361449711773692" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="2461280118049327" type="System">
                                                    <param id="0" name="Variable">Offset</param>
                                                    <param id="1" name="Value">Length</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="2748743070175341">
                                            <conditions />
                                            <actions>
                                                <action id="-10" name="Set value" sid="5104029568722151" type="Flower">
                                                    <param id="0" name="Instance variable">StartAngleOffset</param>
                                                    <param id="1" name="Value">180 / pi * Offset / CircleR</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="3436117826431733">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="8378923963451775" type="System">
                                                    <param id="0" name="First value">loopindex</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Second value">FlowersCount - 1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="2364997931597442" type="System">
                                                    <param id="0" name="Variable">StartAngle</param>
                                                    <param id="1" name="Value">90 - Flower.StartAngleOffset / 2</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <comment>slide each flower towards its end position</comment>
                                <variable constant="0" name="AngleDifference" sid="7751581080352085" static="0" type="number">0</variable>
                                <event-block sid="5601187823617232">
                                    <conditions>
                                        <condition id="-24" name="For Each (ordered)" sid="6277012592704398" type="System">
                                            <param id="0" name="Object">Flower</param>
                                            <param id="1" name="Expression">Flower.CircleAngle</param>
                                            <param id="2" name="Order">0</param>
                                        </condition>
                                        <condition behavior="DragDrop" id="0" inverted="1" name="Is dragging" sid="5337946490081192" type="Flower" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="8537647783860167" type="System">
                                            <param id="0" name="Variable">AngleDifference</param>
                                            <param id="1" name="Value">(StartAngle + Flower.StartAngleOffset) - Flower.CircleAngle</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="4517039086659289">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="6124984471103008" type="System">
                                                    <param id="0" name="First value">abs(AngleDifference)</param>
                                                    <param id="1" name="Comparison">2</param>
                                                    <param id="2" name="Second value">SLIDESPEED * dt</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="6281626091491547" type="Flower">
                                                    <param id="0" name="Instance variable">CircleAngle</param>
                                                    <param id="1" name="Value">StartAngle + Flower.StartAngleOffset</param>
                                                </action>
                                                <action id="0" name="Call function" sid="6227487392939384" type="Function">
                                                    <param id="0" name="Name">&quot;SetOnCircleXY&quot;</param>
                                                    <param id="1" name="Parameter {n}">Flower.CircleAngle</param>
                                                </action>
                                                <action id="-3" name="Set position" sid="3391265997517801" type="Flower">
                                                    <param id="0" name="X">OnCircleX + CircleCenterX</param>
                                                    <param id="1" name="Y">OnCircleY + CircleCenterY</param>
                                                </action>
                                                <action id="-8" name="Set angle" sid="2935528487068181" type="Flower">
                                                    <param id="0" name="Angle">Flower.CircleAngle - 90</param>
                                                </action>
                                                <action id="9" name="Set scale" sid="5917519747903107" type="Flower">
                                                    <param id="0" name="Scale">CirclePieceScale - abs(90 - Flower.CircleAngle) * PieceScaleAttenuationPerDegree</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="6579805775674016">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="9034088257747038" type="System" />
                                                <condition id="-8" name="Compare two values" sid="2595643280538478" type="System">
                                                    <param id="0" name="First value">AngleDifference</param>
                                                    <param id="1" name="Comparison">4</param>
                                                    <param id="2" name="Second value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="575124766288385" type="Function">
                                                    <param id="0" name="Name">&quot;SetOnCircleXY&quot;</param>
                                                    <param id="1" name="Parameter {n}">angle(CircleCenterX, CircleCenterY, Flower.X, Flower.Y) + SLIDESPEED * dt</param>
                                                </action>
                                                <action id="-3" name="Set position" sid="2400586608184715" type="Flower">
                                                    <param id="0" name="X">OnCircleX + CircleCenterX</param>
                                                    <param id="1" name="Y">OnCircleY + CircleCenterY</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="8358421384463115" type="Flower">
                                                    <param id="0" name="Instance variable">CircleAngle</param>
                                                    <param id="1" name="Value">angle(CircleCenterX, CircleCenterY, Flower.X, Flower.Y)</param>
                                                </action>
                                                <action id="-8" name="Set angle" sid="9902229300592356" type="Flower">
                                                    <param id="0" name="Angle">Flower.CircleAngle - 90</param>
                                                </action>
                                                <action id="9" name="Set scale" sid="8023323457640766" type="Flower">
                                                    <param id="0" name="Scale">CirclePieceScale - abs(90 - Flower.CircleAngle) * PieceScaleAttenuationPerDegree</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="9951369969970039">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="3852733984829281" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="3486296301619768" type="Function">
                                                    <param id="0" name="Name">&quot;SetOnCircleXY&quot;</param>
                                                    <param id="1" name="Parameter {n}">angle(CircleCenterX, CircleCenterY, Flower.X, Flower.Y) - SLIDESPEED * dt</param>
                                                </action>
                                                <action id="-3" name="Set position" sid="8353147774364758" type="Flower">
                                                    <param id="0" name="X">OnCircleX + CircleCenterX</param>
                                                    <param id="1" name="Y">OnCircleY + CircleCenterY</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="8151339211600287" type="Flower">
                                                    <param id="0" name="Instance variable">CircleAngle</param>
                                                    <param id="1" name="Value">angle(CircleCenterX, CircleCenterY, Flower.X, Flower.Y)</param>
                                                </action>
                                                <action id="-8" name="Set angle" sid="5121246746774932" type="Flower">
                                                    <param id="0" name="Angle">Flower.CircleAngle - 90</param>
                                                </action>
                                                <action id="9" name="Set scale" sid="1339363962510739" type="Flower">
                                                    <param id="0" name="Scale">CirclePieceScale - abs(90 - Flower.CircleAngle) * PieceScaleAttenuationPerDegree</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group collapsed="1" description="" sid="3226562301188418" title="save necklace">
                    <sub-events>
                        <event-block collapsed="1" sid="8305976236237976">
                            <conditions>
                                <condition id="0" name="On function" sid="8918132678405419" type="Function">
                                    <param id="0" name="Name">&quot;SaveNecklace&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="3618125526102986">
                                    <conditions>
                                        <condition id="-24" name="For Each (ordered)" sid="6049228956489259" type="System">
                                            <param id="0" name="Object">Flower</param>
                                            <param id="1" name="Expression">Flower.CircleAngle</param>
                                            <param id="2" name="Order">1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="4" name="Set at XYZ" sid="7373581203448154" type="NecklacesArray">
                                            <param id="0" name="X">Level</param>
                                            <param id="1" name="Y">SaveSlot</param>
                                            <param id="2" name="Z">loopindex</param>
                                            <param id="3" name="Value">Flower.AnimationFrame</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="6495388000439239">
                                    <conditions />
                                    <actions>
                                        <action id="0" name="Call function" sid="9712592454647976" type="Function">
                                            <param id="0" name="Name">&quot;SaveNecklacesArray&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block collapsed="1" sid="8085762786691675">
                            <conditions>
                                <condition id="3" name="On touched object" sid="3207957600397695" type="Touch">
                                    <param id="0" name="Object">Button</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <comment>save the necklace and delete the collected flowers slot</comment>
                                <event-block sid="9457359414735733">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="7221993594680059" type="System">
                                            <param id="0" name="First value">Button.action</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Second value">&quot;Phase 3 - Decorate&quot;</param>
                                        </condition>
                                        <condition id="-9" name="Is visible" sid="6967773360431327" type="Button" />
                                        <condition id="12" inverted="1" name="Has Nth touch" sid="3979241894786841" type="Touch">
                                            <param id="0" name="Touch number">1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="660569198958765" type="Function">
                                            <param id="0" name="Name">&quot;SaveNecklace&quot;</param>
                                            <param id="1" name="Parameter {n}"></param>
                                        </action>
                                        <action id="4" name="Set at XYZ" sid="3063508700284867" type="NecklacesArray">
                                            <param id="0" name="X">0</param>
                                            <param id="1" name="Y">8</param>
                                            <param id="2" name="Z">0</param>
                                            <param id="3" name="Value">-1</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="1431939279904406">
                                            <conditions>
                                                <condition id="-14" name="Compare variable" sid="1343176242236144" type="System">
                                                    <param id="0" name="Variable">IsNewNecklace</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="2650621058058251" type="Function">
                                                    <param id="0" name="Name">&quot;LogFinishedLevel&quot;</param>
                                                    <param id="1" name="Parameter {n}">&quot;Create - Level &quot; &amp; Level</param>
                                                </action>
                                                <action id="0" name="Call function" sid="8700497725976469" type="Function">
                                                    <param id="0" name="Name">&quot;LogStartLevel&quot;</param>
                                                    <param id="1" name="Parameter {n}">&quot;Decorate - Level &quot; &amp; Level</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="523351894494592">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="2236808568512606" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="2159808623209191" type="Function">
                                                    <param id="0" name="Name">&quot;LogStat&quot;</param>
                                                    <param id="1" name="Parameter {n}">&quot;Preview - Level  &quot; &amp; Level{###}1</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <event-block sid="5931628521325798">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="5424289776528841" type="System">
                                            <param id="0" name="First value">Button.action</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Second value">&quot;Saves&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="273254166009484">
                                            <conditions>
                                                <condition id="-14" name="Compare variable" sid="3821053938906209" type="System">
                                                    <param id="0" name="Variable">IsFinished</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="6737491114814494" type="Function">
                                                    <param id="0" name="Name">&quot;SaveNecklace&quot;</param>
                                                    <param id="1" name="Parameter {n}"></param>
                                                </action>
                                                <action id="4" name="Set at XYZ" sid="2773067903992372" type="NecklacesArray">
                                                    <param id="0" name="X">0</param>
                                                    <param id="1" name="Y">8</param>
                                                    <param id="2" name="Z">0</param>
                                                    <param id="3" name="Value">-1</param>
                                                </action>
                                            </actions>
                                            <sub-events>
                                                <event-block sid="8334488813367972">
                                                    <conditions>
                                                        <condition id="-14" name="Compare variable" sid="668156957235544" type="System">
                                                            <param id="0" name="Variable">IsNewNecklace</param>
                                                            <param id="1" name="Comparison">0</param>
                                                            <param id="2" name="Value">1</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="0" name="Call function" sid="704094510148918" type="Function">
                                                            <param id="0" name="Name">&quot;LogFinishedLevel&quot;</param>
                                                            <param id="1" name="Parameter {n}">&quot;Create - Level &quot; &amp; Level</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                                <event-block sid="2135957721509553">
                                                    <conditions>
                                                        <condition id="-22" name="Else" sid="2413421997303296" type="System" />
                                                    </conditions>
                                                    <actions>
                                                        <action id="0" name="Call function" sid="8580735079542094" type="Function">
                                                            <param id="0" name="Name">&quot;LogStat&quot;</param>
                                                            <param id="1" name="Parameter {n}">&quot;Saves from Create - Level  &quot; &amp; Level{###}1</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                        <event-block sid="9739241888423451">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="9584609490266053" type="System" />
                                            </conditions>
                                            <actions />
                                            <sub-events>
                                                <event-block sid="6328061284881298">
                                                    <conditions>
                                                        <condition id="-14" name="Compare variable" sid="2935989430843441" type="System">
                                                            <param id="0" name="Variable">IsNewNecklace</param>
                                                            <param id="1" name="Comparison">0</param>
                                                            <param id="2" name="Value">1</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="0" name="Call function" sid="5710013191369787" type="Function">
                                                            <param id="0" name="Name">&quot;LogFailedLevel&quot;</param>
                                                            <param id="1" name="Parameter {n}">&quot;Create - Level &quot; &amp; Level</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                                <event-block sid="2565530169708437">
                                                    <conditions>
                                                        <condition id="-22" name="Else" sid="5551571234263653" type="System" />
                                                    </conditions>
                                                    <actions>
                                                        <action id="0" name="Call function" sid="2435898175299858" type="Function">
                                                            <param id="0" name="Name">&quot;LogStat&quot;</param>
                                                            <param id="1" name="Parameter {n}">&quot;Saves from Create - Level  &quot; &amp; Level{###}1</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
